#include <Arduino.h>
// LED MANIPULATION
#include <FastLED.h>
#define ROWS 16
#define COLUMNS 16
#define NUM_LEDS ROWS *COLUMNS
// NODECUN => GPIO5 = D1
// ESP32 => GPIO5 = D5
#define DATA_PIN 5
#define LED_TYPE WS2812B
#define COLOR_ORDER GRB
#define BRIGHTNESS 50

// INTERNAL LED
#define LED_INTERNAL_PIN 2

int muxStatus = 0;

CRGB leds[NUM_LEDS];
long sprite[ROWS][COLUMNS] = {
    {0x000000, 0x000000, 0x000000, 0x000000, 0x000000, 0x000000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0x000000, 0x000000, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0x000000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0x000000, 0x000000, 0xfea246, 0xaf7e00, 0xfea246, 0xfea246, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0xaf7e00, 0xfea246, 0xaf7e00, 0xfea246, 0xfea246, 0xfea246, 0xaf7e00, 0xfea246, 0xfea246, 0xfea246, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0xfea246, 0xfea246, 0xfea246, 0xaf7e00, 0xfea246, 0xfea246, 0xfea246, 0xaf7e00, 0xaf7e00, 0xf59e3e, 0xaf7e00, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0xaf7e00, 0xaf7e00, 0xfea246, 0xfea246, 0xfea246, 0xfea246, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xb07f02, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0x000000, 0xfea246, 0xfea246, 0xfea246, 0xfea246, 0xfea246, 0xfea246, 0xfea246, 0x000000, 0x000000, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0x000000, 0xaf7e00, 0xaf7e00, 0xff0000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000, 0x000000, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xff0000, 0xaf7e00, 0xaf7e00, 0xff0000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000},
    {0x000000, 0x000000, 0xfea246, 0xfea246, 0xaf7e00, 0xff0000, 0xfea246, 0xff0000, 0xff0000, 0xfea246, 0xff0000, 0xaf7e00, 0xfea246, 0xfea246, 0x000000, 0x000000},
    {0x000000, 0x000000, 0xfea246, 0xfea246, 0xfea246, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xfea246, 0xfea246, 0xfea246, 0x000000, 0x000000},
    {0x000000, 0x000000, 0xfea246, 0xfea246, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xff0000, 0xfea246, 0xfea246, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0x000000, 0xff0000, 0xff0000, 0xff0000, 0x000000, 0x000000, 0xff0000, 0xff0000, 0xff0000, 0x000000, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0x000000, 0xb07f02, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000, 0x000000, 0x000000, 0xb07f02, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000, 0x000000},
    {0x000000, 0x000000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xb07f02, 0x000000, 0x000000, 0x000000, 0x000000, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0xaf7e00, 0x000000, 0x000000}};

// put function declarations here:
int getArrayPosFromMatrix(int x, int y);

void setup()
{
  // Load LED matrix
  FastLED.addLeds<LED_TYPE, DATA_PIN, COLOR_ORDER>(leds, NUM_LEDS);
  FastLED.setBrightness(BRIGHTNESS);

  pinMode(LED_INTERNAL_PIN, OUTPUT);
}

void loop()
{
  // put your main code here, to run repeatedly:

  FastLED.clear();

  switch (muxStatus)
  {
  case 0:
    for (int x = 0; x < ROWS; x = x + 2)
    {
      for (int y = 0; y < COLUMNS; y++)
      {
        leds[getArrayPosFromMatrix(x, y)] = sprite[x][y];
      }
    }
    break;
  case 1:
    for (int x = 1; x < ROWS; x = x + 2)
    {
      for (int y = 0; y < COLUMNS; y++)
      {
        leds[getArrayPosFromMatrix(x, y)] = sprite[x][y];
      }
    }
    break;
  }

  FastLED.show();

  muxStatus++;
  if (muxStatus > 1)
  {
    muxStatus = 0;
  }
}

// put function definitions here:
int getArrayPosFromMatrix(int x, int y)
{
  return x * COLUMNS + y;
}